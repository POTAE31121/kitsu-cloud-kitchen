<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Payment Simulator</title>
    <link rel="stylesheet" href="dashboard.css">
</head>
<body>
    <div class="login-container">
        <h2>Kitsu Payment Simulator</h2>
        <p>Order ID: <b id="sim-order-id">...</b></p>
        <p>Amount: <b id="sim-amount">...</b> THB</p>
        <hr style="margin: 20px 0;">
        <p>This is a FAKE credit card form for simulation purposes.</p>
        <div class="form-group">
            <label>Card Number</label>
            <input type="text" value="4242 4242 4242 4242" disabled>
        </div>
        <button onclick="simulatePayment('success')">
        Simulate SUCCESSFUL Payment
        </button>

        <button onclick="simulatePayment('failed')">
        Simulate FAILED Payment
        </button>
    </div>
    <script>
        async function simulatePayment(status) {
        const params = new URLSearchParams(window.location.search);

        const payload = {
            intent_id: params.get("intent_id"),
            amount: Number(params.get("amount")),
            status: status
        };

        const res = await fetch(
            "https://kitsu-django-backend.onrender.com/api/webhook/payment/",
            {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify(payload)
            }
        );

        const data = await res.json();
        console.log("Webhook response:", data);
        alert("Webhook sent: " + status);
    }
    </script>

</body>
</html>